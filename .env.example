# Environment Configuration
# Copy this file to .env and update the values as needed

# Environment (localhost, aws)
ENVIRONMENT=localhost
DEBUG=true

# Service Configuration
HOST=0.0.0.0
PORT=8000

# Database Configuration
# For local development (SQLite)
DATABASE_URL=sqlite+aiosqlite:///./youtube_service.db
# For PostgreSQL
# DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/youtube_service

# Redis Configuration
REDIS_URL=redis://localhost:6379/0

# Storage Configuration
DOWNLOAD_BASE_PATH=./downloads
MAX_FILE_SIZE_GB=5

# Processing Configuration
MAX_CONCURRENT_DOWNLOADS=3
DOWNLOAD_TIMEOUT=3600

# YouTube Configuration
YT_DLP_UPDATE_CHECK=false
EXTRACT_FLAT=false

# Security
SECRET_KEY=your-secret-key-here-change-in-production
API_KEY_HEADER=X-API-Key

# AWS Configuration (for production deployment)
# AWS_REGION=us-east-1
# S3_BUCKET_NAME=youtube-downloads-prod
# S3_CLOUDFRONT_DOMAIN=d1234567890.cloudfront.net

# Celery Configuration (for AWS deployment)
# BROKER_URL=sqs://
# RESULT_BACKEND=redis://prod-redis.xxx.cache.amazonaws.com:6379/1

# Monitoring (for AWS deployment)
# CLOUDWATCH_LOG_GROUP=/aws/ecs/youtube-service
# ENABLE_XRAY=true

# ==============================================================================
# Cookie Management Configuration
# ==============================================================================
# These settings control the secure cookie management system for bypassing
# YouTube's anti-bot protection measures.

# Core Cookie Settings
# S3 bucket for storing secure cookie files (REQUIRED for cookie functionality)
# COOKIE_S3_BUCKET=my-service-secure-config

# Base64 encryption key for in-memory cookie encryption (min 32 characters)
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
# Store in AWS Parameter Store/Secrets Manager for production
# COOKIE_ENCRYPTION_KEY=your-32-character-base64-encryption-key-here

# Cookie Refresh and Caching
# Cookie cache refresh interval in minutes (default: 60, range: 5-1440)
COOKIE_REFRESH_INTERVAL=60

# In-memory cookie cache TTL in minutes (default: 60, range: 5-240)
COOKIE_CACHE_TTL_MINUTES=60

# Cookie Validation Settings
# Enable cookie validation and freshness checks (default: true)
COOKIE_VALIDATION_ENABLED=true

# Enable cookie file integrity validation (default: true)
COOKIE_INTEGRITY_CHECKS_ENABLED=true

# Cookie Storage and Backup
# Number of backup cookie files to maintain (default: 3, range: 1-10)
COOKIE_BACKUP_COUNT=3

# Directory for temporary cookie files (default: system temp directory)
# COOKIE_TEMP_DIR=/tmp/cookie-temp

# Cookie Expiration Management
# Days before expiration to show warnings (default: 7, range: 1-90)
COOKIE_EXPIRATION_WARNING_DAYS=7

# Scheduled cookie rotation interval in days (default: 30, range: 7-365)
COOKIE_ROTATION_SCHEDULE_DAYS=30

# Rate Limiting Configuration
# Rate limiting window in seconds (default: 60, range: 30-3600)
COOKIE_RATE_LIMIT_WINDOW=60

# Maximum requests per rate limit window (default: 10, range: 1-100)
COOKIE_RATE_LIMIT_REQUESTS=10

# Error Handling and Alerts
# Consecutive failures before sending alerts (default: 5, range: 1-50)
COOKIE_ALERT_THRESHOLD=5

# Exponential Backoff Configuration
# Initial delay for exponential backoff in seconds (default: 1.0, range: 0.1-10.0)
COOKIE_BACKOFF_INITIAL_DELAY=1.0

# Maximum delay for exponential backoff in seconds (default: 300.0, range: 10.0-3600.0)
COOKIE_BACKOFF_MAX_DELAY=300.0

# Exponential backoff multiplication factor (default: 2.0, range: 1.1-10.0)
COOKIE_BACKOFF_FACTOR=2.0

# Debug and Security Settings
# Enable detailed cookie debug logging - SECURITY RISK in production (default: false)
# WARNING: This may expose sensitive cookie data in logs
COOKIE_DEBUG_LOGGING=false

# ==============================================================================
# Cookie Management Usage Examples
# ==============================================================================

# Local Development Example:
# COOKIE_S3_BUCKET=my-dev-cookies-bucket
# COOKIE_ENCRYPTION_KEY=dev-key-32-chars-minimum-length
# COOKIE_DEBUG_LOGGING=true

# Production AWS Example:
# COOKIE_S3_BUCKET=prod-youtube-secure-config
# COOKIE_ENCRYPTION_KEY={{resolve:ssm-secure:/youtube-service/cookie-encryption-key}}
# COOKIE_CACHE_TTL_MINUTES=30
# COOKIE_ALERT_THRESHOLD=3
# COOKIE_DEBUG_LOGGING=false

# ==============================================================================
# Cookie Management Security Notes
# ==============================================================================
# 1. COOKIE_S3_BUCKET: Use a dedicated, encrypted S3 bucket with strict IAM policies
# 2. COOKIE_ENCRYPTION_KEY: Store in AWS Parameter Store/Secrets Manager, never in code
# 3. COOKIE_DEBUG_LOGGING: MUST be false in production to prevent data exposure
# 4. Cookie files contain sensitive authentication data - handle with extreme care
# 5. Regular cookie rotation (every 30 days) is recommended for security
# 6. Monitor cookie failure rates and set up alerts for degraded authentication